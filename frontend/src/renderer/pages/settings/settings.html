<!DOCTYPE html>
<html lang="zh-TW" style="color-scheme: dark;">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="color-scheme" content="dark">
  <title>Settings - XIV The Calamity</title>
  <link rel="stylesheet" href="settings.css">
</head>
<body>
  <!-- Draggable Title Bar -->
  <div class="title-bar"></div>
  
  <div class="settings-container">
    <!-- Tab Navigation -->
    <nav class="tab-navigation">
      <button class="tab-button active" data-tab="general" data-i18n="settings.tab.general">ä¸€èˆ¬</button>
      <button class="tab-button platform-darwin" data-tab="wine" data-i18n="settings.tab.wine">Wine</button>
      <button class="tab-button platform-linux" data-tab="winexiv" data-i18n="settings.tab.winexiv">Wine-XIV</button>
      <button class="tab-button" data-tab="dalamud" data-i18n="settings.tab.dalamud">Dalamud</button>
      <button class="tab-button" data-tab="about" data-i18n="settings.tab.about">é—œæ–¼</button>
    </nav>

    <!-- Tab Content Container -->
    <div class="tab-content-container">
      <!-- General Tab -->
      <div id="tab-general" class="tab-content active">
        <div class="settings-section">
          <h2 data-i18n="settings.general.basic">åŸºæœ¬è¨­å®š</h2>
          <div class="form-group">
            <div>
              <label for="language" data-i18n="settings.general.language">èªè¨€</label>
              <select id="language">
                <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
                <option value="en-US">English</option>
              </select>
              <p class="help-text" data-i18n="settings.general.language_help">é¸æ“‡ä»‹é¢èªè¨€</p>
            </div>
            <div class="checkbox-group">
              <label>
                <input type="checkbox" id="debugLogging">
                <span data-i18n="settings.general.debug">Debug è¨˜éŒ„</span>
              </label>
              <button id="openLogPathButton" class="btn btn-secondary btn-sm" data-i18n="settings.general.open_log">é–‹å•Ÿ</button>
            </div>
          </div>
        </div>

        <div class="settings-section">
          <h2 data-i18n="settings.general.game">éŠæˆ²è¨­å®š</h2>
          <div class="form-group">
            <div class="full-width">
              <label for="gamePath" data-i18n="settings.general.game_path">éŠæˆ²è·¯å¾‘</label>
              <div class="input-with-button">
                <input type="text" id="gamePath" placeholder="/path/to/game">
                <button id="browseGamePathButton" class="btn btn-secondary" data-i18n="settings.general.browse">ç€è¦½</button>
              </div>
              <p class="help-text" data-i18n="settings.general.game_path_help">æŒ‡å®šéŠæˆ²å®‰è£ç›®éŒ„</p>
            </div>
          </div>
        </div>

        <div class="settings-section">
          <h2 data-i18n="settings.general.test_section">æ¸¬è©¦åŠŸèƒ½</h2>
          <div class="form-group">
            <div class="full-width">
              <button id="testLaunchButton" class="btn btn-secondary" data-i18n="settings.general.test_launch">æ¸¬è©¦å•Ÿå‹•éŠæˆ²</button>
              <p class="help-text" data-i18n="settings.general.test_launch_help">ä¸éœ€ç™»å…¥å³å¯æ¸¬è©¦éŠæˆ²å•Ÿå‹•ï¼Œç„¡æ³•é€£ç·šè‡³ä¼ºæœå™¨</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Wine Tab -->
      <div id="tab-wine" class="tab-content">
        <div class="settings-section">
          <h2 data-i18n="settings.wine.graphics">åœ–å½¢è¨­å®š</h2>
          <div class="form-group">
            <div class="platform-darwin">
              <label>
                <input type="checkbox" id="dxmtEnabled">
                <span data-i18n="settings.wine.dxmt">å•Ÿç”¨ DXMT</span>
              </label>
              <p class="help-text" data-i18n="settings.wine.dxmt_help">macOS Metal è½‰è­¯å±¤</p>
            </div>
            <div class="platform-darwin">
              <label>
                <input type="checkbox" id="metalFxEnabled">
                <span data-i18n="settings.wine.metalfx">å•Ÿç”¨ MetalFX</span>
              </label>
              <p class="help-text" data-i18n="settings.wine.metalfx_help">éœ€è¦ DXMT</p>
            </div>
            <div class="platform-darwin">
              <label for="metalFxFactor" data-i18n="settings.wine.metalfx_factor">MetalFX å€ç‡</label>
              <div class="slider-group">
                <input type="range" id="metalFxFactor" min="1" max="4" step="1" value="2">
                <span id="metalFxFactorValue">2.0x</span>
              </div>
              <p class="help-text" data-i18n="settings.wine.metalfx_factor_help">è¶…è§£æå€ç‡ (1x-4x)</p>
            </div>
            <div>
              <label>
                <input type="checkbox" id="hudEnabled">
                <span data-i18n="settings.wine.hud">HUD é¡¯ç¤º</span>
              </label>
              <p class="help-text" data-i18n="settings.wine.hud_help">é¡¯ç¤ºæ•ˆèƒ½ç›£æ§</p>
            </div>
            <div>
              <label for="hudScale" data-i18n="settings.wine.hud_scale">HUD å¤§å°</label>
              <div class="slider-group">
                <input type="range" id="hudScale" min="0.5" max="2.0" step="0.5" value="1.0">
                <span id="hudScaleValue">1.0x</span>
              </div>
            </div>
            <div class="platform-darwin">
              <label>
                <input type="checkbox" id="nativeResolution">
                <span data-i18n="settings.wine.native_resolution">åŸç”Ÿè§£æåº¦</span>
              </label>
              <p class="help-text" data-i18n="settings.wine.native_resolution_help">ä½¿ç”¨ Retina åŸç”Ÿè§£æåº¦ï¼ˆç•«è³ªè¼ƒé«˜ä½†æ•ˆèƒ½éœ€æ±‚è¼ƒé«˜ï¼‰</p>
            </div>
            <div>
              <label for="maxFramerate" data-i18n="settings.wine.max_framerate">æœ€é«˜å¹€ç‡</label>
              <input type="number" id="maxFramerate" min="30" max="240" step="10" value="60">
              <p class="help-text" data-i18n="settings.wine.max_framerate_help">é™åˆ¶æœ€é«˜ FPS (30-240)</p>
            </div>
          </div>
        </div>

        <div class="settings-section">
          <h2 data-i18n="settings.wine.audio">éŸ³è¨Šè¨­å®š</h2>
          <div class="form-group">
            <div>
              <label>
                <input type="checkbox" id="audioRouting">
                <span data-i18n="settings.wine.audio_routing">éŸ³è¨Šè·¯ç”±</span>
              </label>
              <p class="help-text" data-i18n="settings.wine.audio_routing_help">æ”¹å–„éŸ³è¨Šç›¸å®¹æ€§</p>
            </div>
          </div>
        </div>

        <div class="settings-section">
          <h2 data-i18n="settings.wine.advanced">é€²éšè¨­å®š</h2>
          <div class="form-group">
            <div>
              <label>
                <input type="checkbox" id="esyncEnabled">
                <span data-i18n="settings.wine.esync">Esync</span>
              </label>
              <p class="help-text" data-i18n="settings.wine.esync_help">äº‹ä»¶åŒæ­¥æ©Ÿåˆ¶</p>
            </div>
            <div class="platform-linux">
              <label>
                <input type="checkbox" id="fsyncEnabled">
                <span data-i18n="settings.wine.fsync">Fsync</span>
              </label>
              <p class="help-text" data-i18n="settings.wine.fsync_help">å¿«é€ŸåŒæ­¥æ©Ÿåˆ¶ (Linux)</p>
            </div>
            <div>
              <label>
                <input type="checkbox" id="msyncEnabled">
                <span data-i18n="settings.wine.msync">Msync</span>
              </label>
              <p class="help-text" data-i18n="settings.wine.msync_help">macOS åŒæ­¥æ©Ÿåˆ¶</p>
            </div>
            <div class="full-width">
              <label for="wineDebug" data-i18n="settings.wine.wine_debug">Wine Debug åƒæ•¸</label>
              <input type="text" id="wineDebug" placeholder="-all,+module">
              <p class="help-text" data-i18n="settings.wine.wine_debug_help">Wine é™¤éŒ¯åƒæ•¸ (ç•™ç©ºåœç”¨)</p>
            </div>
          </div>
          <div class="button-group">
            <button id="openWineCfgButton" class="btn btn-secondary btn-sm" data-i18n="settings.wine.open_winecfg">Winecfg</button>
            <button id="openRegeditButton" class="btn btn-secondary btn-sm" data-i18n="settings.wine.open_regedit">ç™»éŒ„ç·¨è¼¯å™¨</button>
            <button id="openCmdButton" class="btn btn-secondary btn-sm" data-i18n="settings.wine.open_cmd">å‘½ä»¤åˆ—</button>
          </div>
        </div>

        <div class="settings-section platform-darwin">
          <h2 data-i18n="settings.wine.keyboard_mapping">æŒ‰éµæ˜ å°„</h2>
          <div class="form-group">
            <div>
              <label for="leftOptionMapping" data-i18n="settings.wine.left_option">å·¦å´ Option éµ</label>
              <select id="leftOptionMapping">
                <option value="true" data-i18n="settings.wine.key_as_alt">æ˜ å°„ç‚º Alt</option>
                <option value="false" data-i18n="settings.wine.key_as_option">ä¿æŒ Option</option>
              </select>
            </div>
            <div>
              <label for="rightOptionMapping" data-i18n="settings.wine.right_option">å³å´ Option éµ</label>
              <select id="rightOptionMapping">
                <option value="true" data-i18n="settings.wine.key_as_alt">æ˜ å°„ç‚º Alt</option>
                <option value="false" data-i18n="settings.wine.key_as_option">ä¿æŒ Option</option>
              </select>
            </div>
            <div>
              <label for="leftCommandMapping" data-i18n="settings.wine.left_command">å·¦å´ Command éµ</label>
              <select id="leftCommandMapping">
                <option value="true" data-i18n="settings.wine.key_as_ctrl">æ˜ å°„ç‚º Ctrl</option>
                <option value="false" data-i18n="settings.wine.key_as_alt_key">æ˜ å°„ç‚º Alt</option>
              </select>
            </div>
            <div>
              <label for="rightCommandMapping" data-i18n="settings.wine.right_command">å³å´ Command éµ</label>
              <select id="rightCommandMapping">
                <option value="true" data-i18n="settings.wine.key_as_ctrl">æ˜ å°„ç‚º Ctrl</option>
                <option value="false" data-i18n="settings.wine.key_as_alt_key">æ˜ å°„ç‚º Alt</option>
              </select>
            </div>
          </div>
        </div>
      </div>

      <!-- Wine-XIV Tab (Linux Only) -->
      <div id="tab-winexiv" class="tab-content">
        <div class="settings-section">
          <h2 data-i18n="settings.winexiv.graphics">åœ–å½¢è¨­å®š</h2>
          <div class="form-group">
            <div>
              <label>
                <input type="checkbox" id="winexivDxvkHudEnabled">
                <span data-i18n="settings.winexiv.dxvk_hud">DXVK HUD é¡¯ç¤º</span>
              </label>
              <p class="help-text" data-i18n="settings.winexiv.dxvk_hud_help">é¡¯ç¤º DXVK æ•ˆèƒ½ç›£æ§</p>
            </div>
            <div>
              <label for="winexivMaxFramerate" data-i18n="settings.winexiv.max_framerate">æœ€é«˜å¹€ç‡</label>
              <input type="number" id="winexivMaxFramerate" min="30" max="240" step="10" value="60">
              <p class="help-text" data-i18n="settings.winexiv.max_framerate_help">é™åˆ¶æœ€é«˜ FPS (30-240)</p>
            </div>
          </div>
        </div>

        <!-- GameMode disabled due to compatibility issues -->
        <!--
        <div class="settings-section">
          <h2 data-i18n="settings.winexiv.performance">æ•ˆèƒ½è¨­å®š</h2>
          <div class="form-group">
            <div>
              <label>
                <input type="checkbox" id="winexivGameModeEnabled">
                <span data-i18n="settings.winexiv.gamemode">å•Ÿç”¨ GameMode</span>
              </label>
              <p class="help-text" data-i18n="settings.winexiv.gamemode_help">Feral GameMode æ•ˆèƒ½å„ªåŒ–</p>
            </div>
          </div>
        </div>
        -->

        <div class="settings-section">
          <h2 data-i18n="settings.winexiv.advanced">é€²éšè¨­å®š</h2>
          <div class="form-group">
            <div>
              <label>
                <input type="checkbox" id="winexivEsyncEnabled">
                <span data-i18n="settings.winexiv.esync">Esync</span>
              </label>
              <p class="help-text" data-i18n="settings.winexiv.esync_help">äº‹ä»¶åŒæ­¥æ©Ÿåˆ¶</p>
            </div>
            <div>
              <label>
                <input type="checkbox" id="winexivFsyncEnabled">
                <span data-i18n="settings.winexiv.fsync">Fsync</span>
              </label>
              <p class="help-text" data-i18n="settings.winexiv.fsync_help">å¿«é€ŸåŒæ­¥æ©Ÿåˆ¶ (éœ€è¦ Linux 5.16+)</p>
            </div>
            <div>
              <label for="winexivWineDebug" data-i18n="settings.winexiv.wine_debug">Wine Debug</label>
              <input type="text" id="winexivWineDebug" placeholder="-all,+module">
              <p class="help-text" data-i18n="settings.winexiv.wine_debug_help">Wine é™¤éŒ¯æ——æ¨™ (é€²éšä½¿ç”¨è€…)</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Dalamud Tab -->
      <div id="tab-dalamud" class="tab-content hidden">
        <div class="settings-section">
          <h2 data-i18n="settings.tab.dalamud">Dalamud</h2>
          <div class="form-group">
            <div>
              <label>
                <input type="checkbox" id="dalamudEnabled">
                <span data-i18n="settings.dalamud.enable">å•Ÿç”¨ Dalamud</span>
              </label>
              <p class="help-text" data-i18n="settings.dalamud.enable_help">è¼‰å…¥éŠæˆ²æ’ä»¶æ¡†æ¶</p>
            </div>
            <div>
              <label data-i18n="settings.dalamud.version">Dalamud ç‰ˆæœ¬</label>
              <div class="readonly-field" id="dalamudVersion">-</div>
            </div>
            <div>
              <label for="injectDelay" data-i18n="settings.dalamud.inject_delay">æ³¨å…¥å»¶é²ï¼ˆæ¯«ç§’ï¼‰</label>
              <input type="number" id="injectDelay" value="5000" min="0" max="30000" step="100">
              <p class="help-text" data-i18n="settings.dalamud.inject_delay_help">éŠæˆ²å•Ÿå‹•å¾Œç­‰å¾…æ™‚é–“</p>
            </div>
            <div>
              <label>
                <input type="checkbox" id="safeMode">
                <span data-i18n="settings.dalamud.safe_mode">å®‰å…¨æ¨¡å¼</span>
              </label>
              <p class="help-text" data-i18n="settings.dalamud.safe_mode_help">åœç”¨ç¬¬ä¸‰æ–¹æ’ä»¶</p>
            </div>
            <div class="full-width">
              <label for="pluginRepoUrl" data-i18n="settings.dalamud.plugin_repo">æ’ä»¶å€‰åº« URL</label>
              <input type="text" id="pluginRepoUrl" placeholder="https://">
              <p class="help-text" data-i18n="settings.dalamud.plugin_repo_help">è‡ªè¨‚æ’ä»¶ä¾†æº</p>
            </div>
          </div>
        </div>
      </div>

      <!-- About Tab -->
      <div id="tab-about" class="tab-content">
        <div class="about-container">
          <div class="app-logo">
            <img src="../../assets/app-icon-full.png" alt="XIV The Calamity" class="app-icon-image">
            <h1>XIV The Calamity</h1>
          </div>

          <div class="about-section">
            <h2 data-i18n="settings.about.app_info">æ‡‰ç”¨ç¨‹å¼è³‡è¨Š</h2>
            <div class="info-grid">
              <div class="info-item">
                <span class="info-label" data-i18n="settings.about.version">ç‰ˆæœ¬</span>
                <span class="info-value" id="appVersion">1.0.0</span>
              </div>
            </div>
          </div>

          <div class="about-section">
            <h2 data-i18n="settings.about.links">é€£çµ</h2>
            <div class="links-container">
              <button id="githubLink" class="link-button" data-i18n="settings.about.github">GitHub å„²å­˜åº«</button>
              <button id="showLicenseButton" class="link-button" data-i18n="settings.about.show_license">é¡¯ç¤ºæˆæ¬Šæ¢æ¬¾</button>
              <blockquote><style data-styled="true" data-styled-version="5.3.3">.eDynhg{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;width:204px;height:40px;padding:8px 16px;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border-radius:12px;color:white;-webkit-text-decoration:none !important;text-decoration:none !important;}/*!sc*/
.eDynhg:hover{-webkit-text-decoration:none !important;text-decoration:none !important;}/*!sc*/
data-styled.g160[id="sc-1ykasxb-0"]{content:"eDynhg,"}/*!sc*/
</style><a style="background-color:#CCA78C;color:#fff;border:none" href="https://plusone.bobaboba.me" target="_blank" class="sc-1ykasxb-0 eDynhg"><img height="100%" src="https://s3.ap-southeast-1.amazonaws.com/media.anyonelab.com/images/boba/boba-embed-icon.png" alt="boba-icon"/><div style="flex:1;text-align:center">Give me a Boba!</div></a></blockquote>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div class="settings-footer">
      <button id="cancelButton" class="btn btn-secondary" data-i18n="button.cancel">å–æ¶ˆ</button>
      <button id="applyButton" class="btn btn-secondary" data-i18n="button.apply">å¥—ç”¨</button>
      <button id="saveButton" class="btn btn-primary" data-i18n="button.save">å„²å­˜</button>
    </div>
  </div>

  <!-- Loading Overlay -->
  <div id="loadingOverlay" class="loading-overlay" style="display: none;">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <p class="loading-text" data-i18n="settings.wine.launching_tool">æ­£åœ¨å•Ÿå‹• Wine å·¥å…·...</p>
    </div>
  </div>

  <!-- Game Running Overlay -->
  <div id="gameRunningOverlay" class="loading-overlay" style="display: none;">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <p class="loading-text" id="gameRunningText" data-i18n="settings.dalamud.game_running">éŠæˆ²åŸ·è¡Œä¸­...</p>
    </div>
  </div>

  <!-- Exit Code Dialog -->
  <div id="exitCodeDialog" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      <h2 data-i18n="settings.dalamud.game_exited">éŠæˆ²å·²çµæŸ</h2>
      <p id="exitCodeMessage"></p>
      <div class="modal-buttons">
        <button id="exitCodeOkButton" class="btn btn-primary" data-i18n="button.ok">ç¢ºå®š</button>
      </div>
    </div>
  </div>

  <!-- Game Directory Setup Dialog -->
  <div id="gameSetupDialog" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      <h2 data-i18n="settings.game_setup.title">éŠæˆ²ç›®éŒ„è¨­å®š</h2>
      <p data-i18n="settings.game_setup.description">è«‹é¸æ“‡æ‚¨çš„éŠæˆ²å®‰è£æ–¹å¼</p>
      <div class="modal-buttons">
        <button id="existingGameButton" class="btn btn-primary" data-i18n="settings.game_setup.existing">æˆ‘å·²æœ‰éŠæˆ²</button>
        <button id="installGameButton" class="btn btn-secondary" data-i18n="settings.game_setup.install">å®‰è£æ–°éŠæˆ²</button>
        <button id="cancelSetupButton" class="btn btn-secondary" data-i18n="button.cancel">å–æ¶ˆ</button>
      </div>
    </div>
  </div>

  <!-- Konami Code Dialog -->
  <div id="konamiCodeOverlay" class="modal-overlay hidden" style="display: none;">
    <div class="modal-content">
      <h2>ğŸ”“ KONAMI Code Detected!</h2>
      <p data-i18n="settings.konami.prompt">æ˜¯å¦å•Ÿç”¨ Dalamud è¨­å®šé é¢ï¼Ÿ</p>
      <div class="modal-buttons">
        <button id="konamiYesBtn" class="btn btn-primary" data-i18n="button.yes">æ˜¯</button>
        <button id="konamiNoBtn" class="btn btn-secondary" data-i18n="button.no">å¦</button>
      </div>
    </div>
  </div>

  <script type="module" src="settings.js"></script>
</body>
</html>
